---
const { sources = [] } = Astro.props;
---

{
  sources.length > 0 ? (
    <img
      src={sources[0]}
      alt="Wigglegram"
      class="cursor-crosshair block mb-4 h-96 w-auto object-cover"
      id="gif"
    />
  ) : null
}

<script is:inline define:vars={{ sources }}>
  const gifSources = sources;

  let currentIndex = 0;
  const gifElement = document.getElementById("gif");
  let autoRotateInterval;

  function rotateGif() {
    currentIndex = (currentIndex + 1) % gifSources.length;
    if (gifElement) {
      gifElement.src = gifSources[currentIndex];
    }
  }

  function resetAutoRotate() {
    clearInterval(autoRotateInterval);
    autoRotateInterval = setInterval(rotateGif, 5000);
  }

  // Add click/tap event listener
  gifElement?.addEventListener("click", function () {
    rotateGif();
    resetAutoRotate();
  });

  // Add touch event for better mobile responsiveness
  gifElement?.addEventListener("touchend", function (e) {
    e.preventDefault();
    rotateGif();
    resetAutoRotate();
  });

  // Start auto-rotation every 5 seconds
  autoRotateInterval = setInterval(rotateGif, 4000);
</script>
